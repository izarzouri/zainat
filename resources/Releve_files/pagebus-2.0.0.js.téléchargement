!function(e,t,r,i,s){var n=n||new function(){var t="org.openajax.hub.",r={};this.hub=r,r.implementer="http://openajax.org",r.implVersion="2.0",r.specVersion="2.0",r.implExtraData={};var i={};r.libraries=i,r.registerLibrary=function(e,r,s,n){i[e]={prefix:e,namespaceURI:r,version:s,extraData:n},this.publish(t+"registerLibrary",i[e])},r.unregisterLibrary=function(e){this.publish(t+"unregisterLibrary",i[e]),delete i[e]},r._subscriptions={c:{},s:[]},r._cleanup=[],r._subIndex=0,r._pubDepth=0,r.subscribe=function(t,r,i,s,n){i||(i=e);var c=t+"."+this._subIndex,u={scope:i,cb:r,fcb:n,data:s,sid:this._subIndex++,hdl:c},h=t.split(".");return this._subscribe(this._subscriptions,h,0,u),c},r.publish=function(e,t){var r=e.split(".");if(this._pubDepth++,this._publish(this._subscriptions,r,0,e,t),this._pubDepth--,this._cleanup.length>0&&0==this._pubDepth){for(var i=0;i<this._cleanup.length;i++)this.unsubscribe(this._cleanup[i].hdl);delete this._cleanup,this._cleanup=[]}},r.unsubscribe=function(e){var t=e.split("."),r=t.pop();this._unsubscribe(this._subscriptions,t,0,r)},r._subscribe=function(e,t,r,i){var s=t[r];r==t.length?e.s.push(i):("undefined"==typeof e.c&&(e.c={}),"undefined"==typeof e.c[s]?(e.c[s]={c:{},s:[]},this._subscribe(e.c[s],t,r+1,i)):this._subscribe(e.c[s],t,r+1,i))},r._publish=function(e,t,r,i,s,n){if("undefined"!=typeof e){var c;if(r==t.length?c=e:(this._publish(e.c[t[r]],t,r+1,i,s,n),this._publish(e.c["*"],t,r+1,i,s,n),c=e.c["**"]),"undefined"!=typeof c)for(var u=c.s,h=u.length,a=0;h>a;a++)if(u[a].cb){var o=u[a].scope,p=u[a].cb,f=u[a].fcb,_=u[a].data;"string"==typeof p&&(p=o[p]),"string"==typeof f&&(f=o[f]),(!f||f.call(o,i,s,_))&&p.call(o,i,s,_,n)}}},r._unsubscribe=function(e,t,r,i){if("undefined"!=typeof e){if(r<t.length){var s=e.c[t[r]];if(this._unsubscribe(s,t,r+1,i),0==s.s.length){for(var n in s.c)return;delete e.c[t[r]]}return}for(var c=e.s,u=c.length,h=0;u>h;h++)if(i==c[h].sid)return this._pubDepth>0?(c[h].cb=null,this._cleanup.push(c[h])):c.splice(h,1),void 0}}};n.hub.registerLibrary("OpenAjax","http://openajax.org/hub","1.0",{});var c=c||new function(){var t=0,r=[],i=this;this.version="2.0.0",this._debug=function(){},_badParm=function(){throw new Error("OpenAjax.hub.Errors.BadParameters")},_valPub=function(e){(null==e||-1!=e.indexOf("*")||-1!=e.indexOf("..")||"."==e.charAt(0)||"."==e.charAt(e.length-1))&&_badParm()},_valSub=function(e){for(var t=e.split("."),r=t.length,i=0;r>i;i++)(""==t[i]||-1!=t[i].indexOf("*")&&"*"!=t[i]&&"**"!=t[i])&&_badParm(),"**"==t[i]&&r-1>i&&_badParm();return t},_cacheIt=function(e){return e&&"object"==typeof e&&e.PageBus&&e.PageBus.cache},_TopicMatcher=function(){this._items={}},_TopicMatcher.prototype.store=function(e,t){var r=e.split("."),i=r.length;_recurse=function(s,n){if(n==i)s["."]={topic:e,value:t};else{var c=r[n];s[c]||(s[c]={}),_recurse(s[c],n+1)}},_recurse(this._items,0)},_TopicMatcher.prototype.match=function(e,t){var r=e.split("."),i=r.length,s=[];return _recurse=function(e,n){if(e){var c;if(n==i)c=e;else{if(_recurse(e[r[n]],n+1),t)return;"**"!=r[n]&&_recurse(e["*"],n+1),c=e["**"]}c&&c["."]&&s.push(c["."])}},_recurse(this._items,0),s},_TopicMatcher.prototype.exists=function(e,t){var r=e.split("."),i=r.length,s=!1;return _recurse=function(e,n){if(e){var c;if(n==i)c=e;else{if(_recurse(e[r[n]],n+1),s||t)return;if("**"!=r[n]&&(_recurse(e["*"],n+1),s))return;c=e["**"]}c&&c["."]&&(s=!0)}},_recurse(this._items,0),s},_TopicMatcher.prototype.clear=function(e){var t=e.split("."),r=t.length;_recurse=function(e,i){if(e)if(i==r)e["."]&&delete e["."];else{_recurse(e[t[i]],i+1);for(var s in e[t[i]])return;delete e[t[i]]}},_recurse(this._items,0)},_TopicMatcher.prototype.wildcardMatch=function(e){var t=e.split("."),r=t.length,i=[];return _recurse=function(e,s){var n,c=t[s];if(e&&s!=r)if("**"==c)for(var u in e)"."!=u&&(n=e[u],n["."]&&i.push(n["."]),_recurse(n,s));else if("*"==c)for(var u in e)"."!=u&&"**"!=u&&(n=e[u],s==r-1?n["."]&&i.push(n["."]):_recurse(n,s+1));else{if(n=e[c],!n)return;s==r-1?n["."]&&i.push(n["."]):_recurse(n,s+1)}},_recurse(this._items,0),i},this._refs={},this._doCache=new _TopicMatcher,this._caches=new _TopicMatcher,_isCaching=function(e){return i._doCache.exists(e,!1)},_copy=function(e){var t;if("object"==typeof e){if(null==e)return null;if(e.constructor==Array){t=[];for(var r=0;r<e.length;r++)t[r]=_copy(e[r]);return t}if(e.constructor==Date)return t=new Date,t.setDate(e.getDate()),t;t={};for(var i in e)t[i]=_copy(e[i]);return t}return e},this._add=function(e,t){var r,i=this._doCache.match(e,!0);i.length>0?r=i[0].value:(r={rc:0},this._doCache.store(e,r)),r.rc++,this._refs[t]=e},this._remove=function(e){var t=this._refs[e];if(t){delete this._refs[e];var r=this._doCache.match(t,!0);if(0!=r.length&&(r[0].value.rc--,0==r[0].value.rc)){this._doCache.clear(t);for(var i=this._caches.wildcardMatch(t),s=0;s<i.length;s++)this._doCache.exists(i[s].topic,!1)||this._caches.clear(i[s].topic)}}},this.subscribe=function(t,r,i,s){s||(s=null);var u=n.hub.subscribe(t,i,r,s);if(_cacheIt(s)){this._add(t,u);for(var h=this.query(t),a=0;a<h.length;a++)try{i.call(r?r:e,h[a].topic,h[a].value,s)}catch(o){c._debug()}}return u},this.publish=function(e,i){if(_valPub(e),r.push({n:e,m:i,d:t+1}),_isCaching(e))try{this._caches.store(e,i)}catch(s){_badParm()}if(0==t)for(;r.length>0;){var c=r.shift();c.n.split(".");try{t=c.d,n.hub.publish(c.n,c.m),t=0}catch(u){throw t=0,u}}},this.unsubscribe=function(e){try{this._remove(e),n.hub.unsubscribe(e)}catch(t){_badParm()}},this.store=function(e,t){if(!_isCaching(e))throw new Error("PageBus.cache.NoCache");this.publish(e,t)},this.query=function(e){try{return _valSub(e),this._caches.wildcardMatch(e)}catch(t){_badParm()}}};n.hub.registerLibrary("PageBus","http://tibco.com/PageBus","1.2.0",{}),s("pagebus",function(){})}(window,document,bnpp.sf31.requirejs,bnpp.sf31.requirejs,bnpp.sf31.define,bnpp.jquery,bnpp.jquery,bnpp.jquery);
//# sourceMappingURL=pagebus-2.0.0.js.map